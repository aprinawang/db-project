-- Drop table User
DROP TABLE IF EXISTS User;

-- Create table User
CREATE TABLE User (
    user_id INTEGER NOT NULL,
    username VARCHAR(25),
    email VARCHAR(255),
    PRIMARY KEY (user_id)
);

-- Drop table Recipe
DROP TABLE IF EXISTS Recipe;

-- Create table Recipe
CREATE TABLE Recipe (
    recipe_name VARCHAR(255) NOT NULL,
    recipe_id INTEGER NOT NULL,
    minutes    INTEGER,
    user_id INTEGER NOT NULL,
    date DATETIME,
    description VARCHAR(6000),
    calories INTEGER,
    PRIMARY KEY (recipe_id),
    FOREIGN KEY (user_id) REFERENCES User(user_id)
);

-- Drop table Ingredient
DROP TABLE IF EXISTS Ingredient;

-- Create table Ingredient
CREATE TABLE Ingredient (
    ingredient_id INTEGER NOT NULL,
    Energy_Kcal INTEGER,
    Protein FLOAT,
    Carbohydrate FLOAT,
    Fiber FLOAT,
    Sugar FLOAT,
    Calcium FLOAT,
    Iron FLOAT,
    Magnesium FLOAT,
    Sodium FLOAT,
    Cholestrl FLOAT,
    Cleaned_Desc VARCHAR(25),
    unit INTEGER,
    volume_quantity INTEGER,
    volume_desc VARCHAR(25),
    weight_quantity INTEGER,
    weight_desc VARCHAR(25),
    PRIMARY KEY (ingredient_id)
);

-- Drop table RecipeIngredientLink
DROP TABLE IF EXISTS RecipeIngredientLink;

-- Create table RecipeIngredientLink
CREATE TABLE RecipeIngredientLink (
    recipe_id INTEGER NOT NULL,
    ingredient_id INTEGER NOT NULL,
    quantity DECIMAL(4,2),
    quantity_desc VARCHAR(25),
    variant VARCHAR(25),
    FOREIGN KEY (recipe_id) REFERENCES Recipe(recipe_id),
    FOREIGN KEY (ingredient_id) REFERENCES Ingredient(ingredient_id)
);

-- Drop table Interaction
DROP TABLE IF EXISTS Interaction;

-- Create table Interaction
CREATE TABLE Interaction (
    user_id INTEGER NOT NULL,
    recipe_id INTEGER NOT NULL,
    date DATETIME,
    rating INTEGER,
    review VARCHAR(20000),
    FOREIGN KEY (user_id) REFERENCES User(user_id),
    FOREIGN KEY (recipe_id) REFERENCES Recipe(recipe_id)
);

-- Drop table Allergy
DROP TABLE IF EXISTS Allergy;

-- Create table Allergy
CREATE TABLE Allergy (
    allergy VARCHAR(25),
    allergy_id INTEGER NOT NULL,
    PRIMARY KEY (allergy_id)
);

-- Drop table Allergens
DROP TABLE IF EXISTS Allergens;

-- Create table Allergens
CREATE TABLE Allergens (
    allergy_id INTEGER NOT NULL,
    ingredient_id INTEGER
);

-- Drop table TagLink
DROP TABLE IF EXISTS TagLink;

-- Create table TagLink
CREATE TABLE TagLink (
    recipe_id INTEGER NOT NULL,
    tag_id INTEGER,
    FOREIGN KEY (recipe_id) REFERENCES Recipe(recipe_id)
);

-- Drop table Tag
DROP TABLE IF EXISTS Tag;

-- Create table Tag
CREATE TABLE Tag (
    tag_id INTEGER NOT NULL,
    tag_name VARCHAR(255),
    FOREIGN KEY (tag_id) REFERENCES Recipe(recipe_id)
);

-- Drop table Steps
DROP TABLE IF EXISTS Steps;

-- Create table Steps
CREATE TABLE Steps (
    recipe_id INTEGER NOT NULL,
    steps VARCHAR(255),
    step_order INTEGER,
    FOREIGN KEY (recipe_id) REFERENCES Recipe(recipe_id)
);

-- Drop table Conversions
DROP TABLE IF EXISTS Conversions;

-- Create table Conversions
CREATE TABLE Conversions (
    from_unit VARCHAR(25),
    to_unit VARCHAR(25),
    factor DECIMAL(5,2)
);
